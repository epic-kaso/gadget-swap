var app=angular.module("SupergeeksWidget",["ui.router","ui.checkbox","ui.bootstrap","ngCookies","ngAnimate","ngSanitize","SupergeeksWidget.Controllers","SupergeeksWidget.Services","SupergeeksWidget.directives"]);app.run(function(e,t,n,o,r){n.get(),r.run(),e.app_data=window.gadget_swap,e.currentGadget=t.fetch(),e.updateAndGetCurrentModel=function(e,t,n){angular.forEach(e,function(e,o){switch(o){case"device_make":t.currentGadget.make||(t.currentGadget.make=e,t.currentGadget.current_make=n.getMakeByName(e));break;case"device_model":t.currentGadget.model||(t.currentGadget.model=n.getModelBySlug(e));break;case"device_size":t.currentGadget.size||(t.currentGadget.size=n.getSizeModelBySlug(e,t.currentGadget.model));break;case"device_network":t.currentGadget.network||(t.currentGadget.network=n.getNetworkBySlug(e));break;case"device-reward":case"device_condition":var r=n.getConditions();t.currentGadget.condition||(t.currentGadget.condition=e);for(var a=0;a<r.length;a++)if(r[a].slug==e){t.currentGadget.condition_value=r[a].value;break}}})},e.$on("$stateChangeStart",function(t,o,r){e.updateAndGetCurrentModel(r,e,n)}),e.$on("$stateNotFound",function(){o.path("/devices")})}),app.constant("ViewBaseURL","/app/partials"),app.config(function(e,t,n){t.when("/devices/:device_make/:device_model/:device_size/:device_network/:device_condition","/devices/:device_make/:device_model/:device_size/:device_network/:device_condition/reward"),t.otherwise("/devices");var o={name:"device-make",url:"/devices",templateUrl:n+"/device-make.html",controller:"DeviceMakeController",resolve:{Makes:function(e){return e.get()}}},r={name:"device-model",url:"/devices/:device_make",templateUrl:n+"/device-model.html",controller:"DeviceModelController",resolve:{Models:function(e,t,n){var o=t.device_make;return n.getModelsFor(o)},CurrentMake:function(e,t){return t.getMakeByName(e.device_make)}}},a={name:"device-size",url:"/devices/:device_make/:device_model",templateUrl:n+"/device-size.html",controller:"DeviceSizeController",resolve:{CurrentModel:function(e,t){return t.getModelByName(e.device_model)}}},i={name:"device-network",url:"/devices/:device_make/:device_model/:device_size",templateUrl:n+"/device-network.html",controller:"DeviceNetworkController",resolve:{CurrentModel:function(e,t){return t.getModelByName(e.device_model)},Networks:function(e,t){return t.getNetworks()}}},c={name:"device-condition",url:"/devices/:device_make/:device_model/:device_size/:device_network",templateUrl:n+"/device-condition.html",controller:"DeviceConditionController",resolve:{CurrentModel:function(e,t){return t.getModelByName(e.device_model)}}},l={name:"parentReward","abstract":!0,template:'<div class="widget-canvas"><div ui-view class="animated reward"></div> </div>',url:"/devices/:device_make/:device_model/:device_size/:device_network/:device_condition"},s={parent:"parentReward",name:"device-reward",url:"/reward",templateUrl:n+"/device-reward.html",controller:"DeviceRewardController",resolve:{CurrentModel:function(e,t){return t.getModelByName(e.device_model)}}},d={parent:"parentReward",name:"swapLocation",url:"/swap-location",templateUrl:n+"/swap-location.html",controller:"DeviceRewardController",resolve:{CurrentModel:function(e,t){return t.getModelByName(e.device_model)}}},u={name:"book-appointment",url:"/book-appointment/:swap_center",templateUrl:n+"/book-appointment.html",controller:"BookAppointmentController"},g={name:"success",url:"/successful-booking",templateUrl:n+"/book-success.html",controller:function(){}};e.state(o).state(r).state(a).state(i).state(c).state(l).state(s).state(d).state(u).state(g)});var app=angular.module("SupergeeksWidget.Controllers",[]);app.controller("NavbarController",["$scope","$rootScope",function(e,t){t.$on("progress-update-event",function(t,n){console.log("Progress Update Event Received"),e.progress=n})}]),app.controller("DeviceMakeController",function(e,t,n,o){n.tiny_heading=o.trustAsHtml('Get <span style="font-size: 30px;color: green;">₦</span> value of your Gadget, Swap Now.'),n.big_heading="First, Select your Gadget Make",n.device_make="others",e.makes=t,console.log(t),e.$emit("progress-update-event","10%")}),app.controller("DeviceModelController",function(e,t,n,o,r,a,i,c){console.log(t),c.big_heading="Next, Select your Model",n.$emit("progress-update-event","20%"),n.currentGadget.make=o.device_make,n.currentGadget.current_make=e,n.image_label=n.currentGadget.make,n.image_url=e.logo_url||"smartphone.png",n.models=t,n.selectModel=function(e,t,r){n.currentGadget.model=t,n.currentGadget.image_url=n.currentGadget.model.image_url||"/Assets/img/smartphone.png",i.go(r,{device_make:o.device_make,device_model:t.slug}),console.log(e),e.preventDefault()}}),app.controller("DeviceSizeController",function(e,t,n,o,r,a,i){a.big_heading="Ok Now, Select your Storage Size",e.$emit("progress-update-event","54%"),e.device_class=a.device_make="others",e.image_label=e.currentGadget.make+" "+e.currentGadget.model.model,e.image_url=e.currentGadget.model.image_url||"/Assets/img/smartphone.png",e.sizes=e.currentGadget.model.sizes,e.selectSize=function(n,o,a){e.currentGadget.size=o,e.currentGadget.baseLinePrice=i.getBaseLinePriceForSize(e.currentGadget.model,o.value),r.go(a,{device_make:t.device_make,device_model:t.device_model,device_size:o.value}),n.preventDefault()}}),app.controller("DeviceNetworkController",function(e,t,n,o,r,a,i){i.big_heading="Please, Select your Network Provider",t.$emit("progress-update-event","65%"),t.device_class=i.device_make="others",t.image_label=t.currentGadget.make+" "+t.currentGadget.model.model,t.image_url=t.currentGadget.model.image_url||"/Assets/img/smartphone.png",t.networks=e,t.selectNetwork=function(e,o,r){t.currentGadget.network=o,a.go(r,{device_make:n.device_make,device_model:n.device_model,device_size:n.device_size,device_network:o.name}),e.preventDefault()}}),app.controller("DeviceConditionController",function(e,t,n,o,r,a){t.tooltips={normal_condition:'<ul class="list-unstyled text-left"><li><span class="glyphicon glyphicon-ok text-info text-justify"></span> Powers on and makes calls</li><li><span class="glyphicon glyphicon-ok text-info text-justify"></span> No visible scratches or cracks</li><li><span class="glyphicon glyphicon-ok text-info text-justify"></span> All buttons click</li><li><span class="glyphicon glyphicon-ok text-info text-justify"></span> Has never been repaired in any way</li></ul>',cracked_condition:'<ul class="list-unstyled text-left"><li><span class="glyphicon glyphicon-ok text-info text-justify"></span>Minor scratches or cracks on device</li><li><span class="glyphicon glyphicon-ok text-info text-justify"></span> Has been repaired in any way</li><li><span class="glyphicon glyphicon-ok text-info text-justify"></span> Some Buttons are not functional</li><li><span class="glyphicon glyphicon-ok text-info text-justify"></span> Normal wear and tear</li></ul>',faulty_condition:'<ul class="list-unstyled text-left"><li><span class="glyphicon glyphicon-ok text-info text-justify"></span> Does not power on or make calls</li><li><span class="glyphicon glyphicon-ok text-info text-justify"></span> Buttons not functional</li><li><span class="glyphicon glyphicon-ok text-info text-justify"></span> Serious physical damage to frame like bends or cracks</li><li><span class="glyphicon glyphicon-ok text-info text-justify"></span> Water damaged before</li><li><span class="glyphicon glyphicon-ok text-info text-justify"></span> Faulty touch screen/ broken LCD</li></ul>'},t.conditions=o.getConditions(),t.image_url=t.currentGadget.model.image_url||"/Assets/img/smartphone.png",a.big_heading="Great! Finally, Which of these best describes your gadget's condition",t.$emit("progress-update-event","70%"),t.device_class=a.device_make="others",t.image_label=t.currentGadget.make+" "+t.currentGadget.model.model+" "+t.currentGadget.size.value+" ",t.viewReward=function(e,o){for(var a=0;a<t.conditions.length;a++)if(t.conditions[a].slug==o){t.currentGadget.condition_value=t.conditions[a].value;break}t.currentGadget.condition=o,t.$emit("progress-update-event","100%"),r.go(e,{device_make:n.device_make,device_model:n.device_model,device_size:n.device_size,device_network:n.device_network,device_condition:t.currentGadget.condition})}}),app.controller("DeviceRewardController",function(e,t,n){t.big_heading="Fantastic,Thank you! Here's your Reward";var o=e.currentGadget.getReward();e.currentGadget.reward=o,angular.isNumber(o)?(e.reward_price=n("currency")(o,"₦")+"*",e.reward_message="Estimated Value is",e.reward_disclaimer="*this value is subject to final verification by our engineers."):e.reward_price=o}),app.controller("BookAppointmentController",function(e,t,n,o,r,a,i){a.big_heading="Book your Swap Now!";var c=e.currentGadget;c.swap_center=t.swap_center,e.swap_center=t.swap_center.split("-").join(" "),e.sendMail=function(e,t,n){var a={device:c,user:{email:e,phone:t}},l=i.postSwapDetails(a);l.then(function(e){console.log(e)},function(e){console.log(e)});var s=o.send(n,e);s.then(function(e){console.log(e),r.go("success")},function(e){console.log(e),alert("Error Occured, try again")})}});var app=angular.module("SupergeeksWidget.directives",[]);app.directive("progressBar",function(){return{restrict:"EA",scope:{val:"="},link:function(e,t){t.css("width","0"),e.$watch("val",function(e){console.log("val changed"),t.css("width",e)})}}}),app.directive("conditionSelect",function(){return{restrict:"EA",scope:{val:"="},link:function(e,t){e.$watch("val",function(e){1==e?t.css("border","#e8e8e8 solid 1px"):t.css("border","none")})}}}),app.directive("previousButton",function(e){return{restrict:"EA",link:function(t,n){n.on("click",function(){e.history.back()})}}}),app.directive("ensureValid",function(){return{restrict:"EA",link:function(e,t){t.on("click",function(){$state.transitionTo(TimeLine.prev())})}}});var app=angular.module("SupergeeksWidget.Services",[]),Gadget=function(){};Gadget.prototype.getValue=function(){var e=this.condition*this.baseLinePrice,t=e*(this.getNetworkBonus()/100);return e+t},Gadget.prototype.getNetworkBonus=function(){return this.network?this.network.description:"none"},Gadget.prototype.getReward=function(){return this.size&&this.baseLinePrice&&this.condition_value?parseInt(parseInt(this.baseLinePrice)*(this.condition_value/100)):"Sorry, You'll have to come to our Swap Location."},app.factory("GadgetServ",function(){var e={},t={};return{getModels:function(){return e},setModels:function(t){e=t},setDevices:function(e){angular.forEach(e,function(e){t[e.name]=e.gadgets},t),console.log(t)},getDevicesFor:function(e){return t[e]}}}),app.factory("MailServ",function(e){var t="https://mandrillapp.com/api/1.0/messages/send.json",n={message:{html:"",text:"",subject:"Supergeeks Widget",from_email:"supergeeks-widget@supergeeks.com.ng",from_name:"Supergeeks Widget",to:[],headers:{"Reply-To":"no-reply@supergeeks.com.ng"},important:!0},key:"XZ6K0JEmpINZY4sw6_1F2g"};return{send:function(o,r){return n.message.html=o,n.message.to.push({email:r,type:"to"}),e.post(t,n)}}}),app.factory("CurrentGadget",function(){var e=new Gadget({});return{fetch:function(){return e}}}),app.factory("GadgetsInfoServ",function(e,t,n,o){var r,a=[{name:"Airtel",image_url:"airtel.jpg"},{name:"Mtn",image_url:"mtn.jpg"},{name:"Glo",image_url:"glo.jpg"},{name:"Etisalat",image_url:"etisalat.jpg"}];return{get:function(){var e=n.defer();return r?e.resolve(r):(t.setModels(window.gadget_swap.data.models),t.setDevices(window.gadget_swap.data.models),r=window.gadget_swap.data,a=window.gadget_swap.data.networks,e.resolve(window.gadget_swap.data)),e.promise},getModelsFor:function(e){return t.getDevicesFor(e)},getMakeByName:function(e){var t={data:""};return angular.forEach(r.models,function(t){return t.name==e?(this.data=t,t):void 0},t),t.data},getModelByName:function(e){var t={data:""};return angular.forEach(r.devices,function(t){return t.model==e&&(this.data=t),t},t),t.data},getModelBySlug:function(e){var t={data:""};return angular.forEach(r.devices,function(t){return t.slug==e&&(this.data=t),t},t),t.data},getSizeModelBySlug:function(e,t){var n={data:""};return angular.forEach(t.sizes,function(t){return t.slug==e&&(this.data=t),t},n),n.data},getNetworks:function(){return console.log(a),a},getBaseLinePriceForSize:function(e,t){var n={data:""};return angular.forEach(e.base_line_prices,function(e){return e.size==t&&(this.data=e.value),e.value},n),n.data},getNetworkBySlug:function(e){for(var t=0;t<a.length;t++)if(a[t].slug==e)return a[t];return{}},getConditions:function(){return[{name:"Like New",slug:"Like-New",value:o.currentGadget.current_make.normal_condition},{name:"Scratches & Cracks",slug:"Scratches-Cracks",value:o.currentGadget.current_make.scratched_condition},{name:"Faulty",slug:"Faulty",value:o.currentGadget.current_make.bad_condition}]},postSwapDetails:function(t){var n=window.location.origin+"/add-swap-detail";return e.post(n,t)}}}),app.factory("PreloadTemplates",function(e,t,n){var o=[n+"/device-make.html",n+"/device-model.html",n+"/device-size.html",n+"/device-network.html",n+"/device-condition.html",n+"/device-reward.html",n+"/book-appointment.html",n+"/book-success.html",n+"/swap-location.html"];return{run:function(){o.forEach(function(n){t.get(n,{cache:e})})}}});